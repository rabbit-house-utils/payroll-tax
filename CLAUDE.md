# PayRoll Tax

这是一个静态网页, 提供根据税前收入计算可支配收入的功能, 以及税务优化方案.

网页托管至github, 但仓库本身是私有的. 绑定域名payroll-tax.rabbit-house.cafe.

## 可支配收入算法

### 月工资

扣除起征点, 五险一金, 专项附加扣除后, 计算应纳税所得额.

此外, 还应注明每月公积金收入, 以及含公积金的税后收入.

各区间税率及速算扣除数如下:

0-36000 3% 0
36000-144000 10% 2520
144000-300000 20% 16920
300000-420000 25% 31920
420000-660000 30% 52920
660000-960000 35% 85920
960000以上 45% 181920

社保个人缴费比例: 养老8%, 医疗2%, 失业0.5%. 公积金缴费比例12%. (双边24%).

注意社保和公积金的缴费基数由用户输入的月工资+年终奖合计决定, 且位于社平工资的60%-300%之间. 社平工资需用户输入, 默认为11937/月.

### 年终奖

年终奖单独计税.

各区间税率及速算扣除数如下:

0-36000 3% 0
36000-144000 10% 210
144000-300000 20% 1410
300000-420000 25% 2660
420000-660000 30% 4410
660000-960000 35% 7160
960000以上 45% 15160

需提供如下选项: 是否可将部分年终奖转为下月工资发放, 是否可将部分年终奖转换为期权. 即有2*2=4种方案. 转换为期权时, 需提供转换比例(一般是折价, 比如7-8折换购, 即用70-80元年终奖换购100元期权). 注意换购期权时需要考虑边际效应, 即年终奖换购的期权需要把当前所有的期权归属方案考虑进来后, 考虑增量.

**转换比例定义**: 转换比例表示折扣率. 如转换比例为75%, 则表示用75元年终奖可换购100元期权. 计算公式: 期权价值 = 年终奖金额 / 转换比例.  

### 股票/期权

股票/期权收入单独计税, 税率表同月工资.

#### 已上市公司股票/期权

已上市公司股票/期权按一次性归属计算, 税额 = (股数 × (归属股价 - 行权价) × 汇率) 的税额. RSU的行权价为0, Option的行权价不为0.

#### 未上市公司期权

未上市公司期权使用边际税率方法计算:

1. 对于多笔期权授予, 按授予顺序依次计算:
   - 第一笔授予: 直接计算税额, 均摊到归属年数
   - 第二笔授予: 计算(第一笔+第二笔)的累计税额, 减去第一笔的税额得到第二笔的边际税额, 均摊到第二笔的归属年数
   - 以此类推

2. 年终奖转期权视为一笔新的授予, 归属年数为1年, 按上述边际税率方法计算其税额

3. 最终年度税额 = 所有授予的年度税额之和

这种方法正确反映了税率累进的边际效应: 后续授予的收入会因为累计收入增加而适用更高的边际税率. 

### 税务规划

针对用户输入的收入方案, 应当首先计算出4种年终奖方案下的可支配收入, 详细展示年终奖收入的转移量(转移量需精确到元). 此外, 还需要针对用户输入的收入总额, 提供4种年终奖方案下的最优收入情况, 包括月工资, 年终奖, 股票/期权的最优分配方案, 以及对应的可支配收入.

## UI设计

### 股票/期权输入界面

使用两个勾选框:
1. **股票或已上市公司期权**: 勾选后显示输入框
   - 股数
   - 归属股价(美元)
   - 行权价(美元, RSU为0, Option不为0)
   - 汇率

2. **未上市公司期权**: 勾选后显示输入框
   - 当前股价(美元)
   - 汇率
   - 期权授予列表(可添加多笔授予, 每笔包含: 总股数, 行权价, 归属年数, 已归属年数)

两种类型可以同时勾选, 但年终奖转期权只适用于未上市公司期权.